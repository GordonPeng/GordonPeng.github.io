# MySQL

SQL语言分类：

* ddl 数据定义语言  对数据库，数据表，数据字段定义
* dml 数据管理语言 增删改
* dql 数据查询语言  查
* dcl 数据控制语言 访问权限，安全级别 创建用户



## 查询

* 基本查询

* 条件查询

* 聚合函数查询

* 分组查询

* 分页查

  

  select     

  from

  where

  group by

  having

  orderby

  limit

  distinct去重

  列1 as 列2  改名

  ifnull（列名,null替换值）




内连接查询

外连接查询

子查询 

自连接查询

## 视图

## 存储过程

定义：

​	事先经过编译，保存在数据库中的一段sql语句集合

好处：

	* 提高代码的复用性
	* 减少数据在服务器之间的传输，提高效率

* 减轻业务代码的处理负担 

存储过程和存储函数

* 存储函数必须有返回值
* 存储过程可以没有返回值

创建和调用

~~~sql
DELIMITER$
create procedure 


CALL 
~~~

## 存储函数 （必须有返回值）

select调用

## 触发器

前置：可以修改new对象

后置：禁止修改new对象



语句级触发器：语句结束后触发

行级触发器：for each row  三个类别



## 事务

定义：在一个最小的逻辑单元中，数据库会操作多次这个单元，每次操作要么全部成功要么一起失败

事务的四大特征：原子隔离一致持久

* 原子性

  操作要么成功要么失败回滚

* 一致性

  从一个一致数据库状态到另一个数据库一致状态

* 隔离性

  多个访问同时操作，事务相互隔离

* 持久性

  提交后永久保存

隔离级别

read uncommitted 未提交读

read commited 提交读

repeatable read 不可重复读

serializable 串行化

问题：

* 脏读：读到另外一个事务没有提交的数据

* 不可重复读：在一次事务中，读到另一个事务提交前后不一致

* 幻读：

  一个事务(同一个read view)在前后两次查询同一范围的时候，后一次查询看到了前一次查询没有看到的行。**两点需要说明**：
   　1、在可重复读隔离级别下，普通查询是快照读，是不会看到别的事务插入的数据的，幻读只在**当前读**下才会出现。
   　2、幻读专指**新插入的行**，读到原本存在行的更新结果不算。因为**当前读**的作用就是能读到所有已经提交记录的最新值。

事务只针对DML



## 高级特性

mysql存储结构：

若干连接

连接池

sql接口 转换器 

数据库引擎

文件

### 数据库存储引擎

* InnoDB 支持事务行锁外键
* MyISAM 访问快 不支持事务和外键  （查询为主，少量更新删除，少量并发）
* MEMORY ：内存存储，速度最快 不支持事务备份 不安全（更新不太重要的小表，用来快速访问）

### 索引

### 锁



* 行锁
* 表锁
* 间隙锁

按操作分类

* 共享锁   多个事务可查询 不能修改  。 锁索引：行级锁 ；不锁索引：表锁。 
* 排他锁   一个事务加锁 其他事务不能对其加锁  insert update 默认携带 排他锁

使用方式分类

* 悲观锁
* 乐观锁



## 范式

设计数据库时，遵循的规范

三范式：

* 保证每一列的原子性
* 一张表只描述一件事 （去杂糅）
* 每列和主键直接相关





